<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Game Room</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <canvas id="gameCanvas"></canvas>
    <div id="chatBox">
        <input id="chatInput" type="text" placeholder="Type a message..." />
        <button id="sendButton">Send</button>
    </div>

    <script src="https://cdn.socket.io/4.5.1/socket.io.min.js"></script>
    <script>
        const socket = io("https://common-verdant-boa.glitch.me/game");

        const canvas = document.getElementById("gameCanvas");
        const ctx = canvas.getContext("2d");
        const chatInput = document.getElementById("chatInput");
        const sendButton = document.getElementById("sendButton");

        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        let players = {};
        const speed = 5; // Player movement speed

        // Handle player movement
        window.addEventListener("keydown", (e) => {
            let move = { x: 0, y: 0 };
            if (e.key === "ArrowUp") move.y = -speed;
            if (e.key === "ArrowDown") move.y = speed;
            if (e.key === "ArrowLeft") move.x = -speed;
            if (e.key === "ArrowRight") move.x = speed;
            socket.emit("move", move);
        });

        // Handle message sending
        sendButton.onclick = () => {
            const message = chatInput.value.trim();
            if (message) {
                socket.emit("message", message);
                chatInput.value = "";
            }
        };

        // Update players from the server
        socket.on("update-players", (serverPlayers) => {
            players = serverPlayers;
            draw();
        });

        // Draw the game
        function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            for (const id in players) {
                const player = players[id];
                // Draw player
                ctx.beginPath();
                ctx.arc(player.x, player.y, 20, 0, Math.PI * 2);
                ctx.fillStyle = id === socket.id ? "rgb(245, 99, 200)" : "rgb(189, 195, 199)"; // Cold pink for local player, gray for others
                ctx.fill();

                // Draw message
                if (player.message) {
                    ctx.font = "16px Arial";
                    ctx.fillStyle = "rgb(245, 99, 200)"; // Cold pink for text
                    ctx.textAlign = "center";
                    ctx.fillText(player.message, player.x, player.y - 30);
                }
            }
        }

        // Resize canvas when the window is resized
        window.addEventListener("resize", () => {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            draw();
        });
    </script>
</body>
</html>
